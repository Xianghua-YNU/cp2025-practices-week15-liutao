# 项目：平方反比引力场中的运动 - 实验报告

**学生姓名：** [刘涛]

**学号：** [20231050159]

**完成日期：** [2025.06.04]

## 1. 实验目的

1. 通过数值模拟研究质点在平方反比引力场（如万有引力或静电场）中的运动规律，并验证能量守恒与角动量守恒

2. 加深对中心力场运动的核心物理概念（能量、角动量、轨道几何）的认识。

## 2. 核心算法与实现

### 2.1 运动方程与数值方法

1. 运动方程（直角坐标系下的二阶微分方程组）
在平方反比引力场中，质点 m 的运动由牛顿第二定律描述，
为便于数值求解，将其转换为一阶常微分方程组（状态空间形式），可以定义状态向量 $y=[x,y,v_x,v_y]$ 。
3. 数值求解方法
采用 scipy.integrate.solve_ivp 求解上述方程组，具体参数设置如下：

（1）积分方法选择

方法：method='RK45'（默认的显式龙格-库塔法，适用于非刚性问题）。该方法是 5(4) 阶自适应步长算法，在保证精度的同时自动调整步长。对于高精度需求，也可选 'DOP853'（高阶龙格-库塔法），但计算成本更高。

（2）容差控制

相对容差：rtol=1e-7，绝对容差：atol=1e-9，通过调整容差可平衡计算效率与精度。较小的容差（如 1e-9）适合高精度需求，但会增加计算时间。

（3）时间设置

时间区间：t_span=(t_start, t_end)，输出时间点：t_eval=np.linspace(t_start, t_end, n_points)，通过 t_eval 指定输出解的时间点，确保结果均匀分布以便绘图和分析。

（4）奇点处理

避免 $r→0$ 的数值问题：在计算 $r^3$ 时添加小量 ϵ 防止除以零错误。
### 2.2 关键函数实现思路

#### `derivatives()` 实现思路：

```python
def derivatives(t, state_vector, gm_val):
    """
    计算状态向量 [x, y, vx, vy] 的导数。

    笛卡尔坐标系中的运动方程为：
    dx/dt = vx
    dy/dt = vy
    dvx/dt = -GM * x / r^3
    dvy/dt = -GM * y / r^3
    其中 r = sqrt(x^2 + y^2)。

    参数：
        t (float): 当前时间（在此自治系统中不直接使用，但solve_ivp需要）
        state_vector (np.ndarray): 一维数组 [x, y, vx, vy] 表示当前状态
        gm_val (float): 引力常数 G 和中心质量 M 的乘积

    返回：
        np.ndarray: 导数的一维数组 [dx/dt, dy/dt, dvx/dt, dvy/dt]
    """
    x, y, vx, vy = state_vector
    r_cubed = (x**2 + y**2)**1.5
    
    # 处理 r 很小时可能出现的除以零情况
    if r_cubed < 1e-12: # 防止除以零的小阈值
        ax = -gm_val * x / (1e-12) if x != 0 else 0
        ay = -gm_val * y / (1e-12) if y != 0 else 0
        return [vx, vy, ax, ay]

    ax = -gm_val * x / r_cubed
    ay = -gm_val * y / r_cubed
    return [vx, vy, ax, ay]
```

#### `slove_orbit()` 实现思路：

```python
def solve_orbit(initial_conditions, t_span, t_eval, gm_val=GM):
    """
    使用 scipy.integrate.solve_ivp 解决轨道运动问题。

    参数：
        initial_conditions (list or np.ndarray): [x0, y0, vx0, vy0] 在 t_start 时的初始状态
        t_span (tuple): (t_start, t_end)，积分区间
        t_eval (np.ndarray): 存储解的时间点数组
        gm_val (float, optional): GM 值。默认为全局 GM

    返回：
        scipy.integrate.OdeSolution: solve_ivp 返回的解对象
                                     通过 sol.y 访问解（转置为 (N_points, N_vars)）
                                     sol.t 包含时间点
    """
    sol = solve_ivp(
        fun=derivatives, 
        t_span=t_span, 
        y0=initial_conditions, 
        t_eval=t_eval, 
        args=(gm_val,),
        method='RK45',  # 5(4)阶显式龙格-库塔方法
        rtol=1e-7,      # 相对容差
        atol=1e-9       # 绝对容差
    )
    return sol
```

## 3. 实验结果与分析

### 3.1 不同总能量下的轨道

![Figure_1](https://github.com/user-attachments/assets/426a60a7-a91e-4b39-9ffc-f6c76b13b60a)

**图1：不同能量下的轨道图 (E<0, E=0, E>0)**

**结果分析：**

1. 形状差异：

椭圆轨道（E=-0.68）：
能量为负值，表示这是一个束缚轨道。椭圆轨道是封闭的，天体在引力束缚下周期性运动。能量越低（负值越大），椭圆轨道越“瘦长”（偏心率越大）；能量接近零时，轨道接近圆形（偏心率趋近于零）。

抛物线轨道（E=0.00）：
总能量为零，是束缚与非束缚轨道的临界状态。轨道形状为抛物线，天体从无限远来，到达最近点后逃逸到无限远，速度恰好为零。这种轨道是开放且不重复的。

双曲线轨道（E=0.44）：
能量为正值，表示天体具有足够的动能克服引力束缚，轨道为非束缚状态。形状为双曲线，天体从无限远以剩余速度接近，经过偏转后逃逸到无限远。

2. 物理意义：

能量是区分轨道是否束缚的关键：负能量对应束缚轨道（椭圆），零能量对应临界状态（抛物线），正能量对应非束缚轨道（双曲线）。

能量绝对值的大小还影响轨道的偏心率：对于椭圆轨道，能量越接近零（如E≈-0.1），轨道越接近圆形；能量越负（如E≈-0.9），轨道越扁长。

**(可选) 能量与角动量守恒验证：**
（如果你进行了能量和角动量随时间变化的计算和绘图，请在此处展示结果，并分析其守恒情况。讨论数值误差对守恒性的影响。）

### 3.2 不同角动量下的椭圆轨道 (E < 0)

![Figure_2](https://github.com/user-attachments/assets/6a854e01-3e6d-4dcb-b199-048ba0e7e247)

**图2：固定能量 (E=[具体值])，不同角动量下的椭圆轨道**

**结果分析：**

1. 角动量与轨道形状的关系：

Lz=1.45（发射角度90°）：角动量最大，对应垂直于径向的初速度分量最大。轨道更“扁平”（半长轴较大，偏心率较小），接近圆形。

Lz=1.25（发射角度60°）：角动量中等，轨道偏心率增大，半长轴可能略减小。

Lz=1.02（发射角度45°）：角动量最小，轨道最“瘦长”（偏心率最大），半短轴显著减小。

2. 角动量如何影响“扁平”程度：

角动量 Lz 与轨道的半短轴 b 直接相关：Lz∝b

在固定能量下，角动量越小，轨道的半短轴越短，偏心率越大，轨道越“瘦长”。

角动量越大，轨道越接近圆形（偏心率趋近于零）

## 4. 问题与收获

### 4.1遇到的主要问题及解决方法
（列出你在完成项目中遇到的1-2个主要困难或挑战，并说明你是如何思考和解决这些问题的。）

**问题1：** [描述问题]
**解决方法：** [描述你的解决思路和过程]

**问题2：** [描述问题]
**解决方法：** [描述你的解决思路和过程]

### 4.2 主要收获与体会
（用3-5句话总结你通过本次实验获得的主要知识、技能或感悟。例如，对轨道力学的理解加深、数值求解ODE的经验、数据可视化的技巧等。）

## 5. (可选) 思考与展望

（如果你完成了可选任务或有其他深入思考，可以在此部分阐述。）

### 5.1 坐标转换与对称性
（如果你研究了极坐标转换和轨道对称性，请在此处分享你的发现和理解。）

### 5.2 其他思考
（例如，此模型有哪些局限性？如何可以进一步扩展或改进这个项目？真实天体运动与此理想模型的差异等。）

