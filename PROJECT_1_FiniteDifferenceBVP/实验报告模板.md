# 项目：二阶常微分方程边值问题求解 - 实验报告

**学生姓名：** [栗政澈]
**学号：** [20231050064]
**完成日期：** [2025/6/6]

## 1. 实验目的

本次实验旨在通过求解一个具体的二阶线性常微分方程边值问题 $y''(x) + \sin(x) y'(x) + e^x y(x) = x^2$ (边界条件 $y(0)=0, y(5)=3$)，掌握并比较有限差分法以及 `scipy.integrate.solve_bvp` 函数这两种数值解法。理解它们的基本原理、实现过程和适用场景。

## 2. 核心算法与实现

简要描述你对每种核心方法的理解和实现思路。
有限差分法的核心思想是将连续的微分方程离散化为线性代数方程组：

将求解区间 $[0, 5]$ 等分为 $n+1$ 个子区间，步长 $h = 5/(n+1)$

使用中心差分近似导数：

$y''(x_i) \approx \frac{y_{i-1} - 2y_i + y_{i+1}}{h^2}$

$y'(x_i) \approx \frac{y_{i+1} - y_{i-1}}{2h}$

将近似代入原方程，得到每个内部点 $i$ 的线性方程

边界条件直接代入：$y_0 = 0$, $y_{n+1} = 3$

构建三对角系数矩阵 $A$ 和右端向量 $b$

求解线性方程组 $A\mathbf{y} = \mathbf{b}$ 得到数值解
### 2.1 有限差分法 (Finite Difference Method)

**算法思路：**
[在此处简述有限差分法的核心思想，例如：如何将连续的微分方程离散化为线性方程组，如何处理边界条件，以及如何求解得到的线性系统。]
有限差分法通过离散化将微分方程转化为代数方程组：

区域离散化：将求解区间 $[0, 5]$ 等分为 $n+1$ 段，步长 $h = 5/(n+1)$

差分近似：

二阶导数：$y''(x_i) \approx \frac{y_{i-1} - 2y_i + y_{i+1}}{h^2}$（中心差分）

一阶导数：$y'(x_i) \approx \frac{y_{i+1} - y_{i-1}}{2h}$（中心差分）

方程离散：在内部点 $x_i (i=1,\dots,n)$ 处代入原方程：
y
i
−
1
−
2
y
i
+
y
i
+
1
h
2
+
sin
⁡
(
x
i
)
y
i
+
1
−
y
i
−
1
2
h
+
e
x
i
y
i
=
x
i
2
h 
2
 
y 
i−1
​
 −2y 
i
​
 +y 
i+1
​
 
​
 +sin(x 
i
​
 ) 
2h
y 
i+1
​
 −y 
i−1
​
 
​
 +e 
x 
i
​
 
 y 
i
​
 =x 
i
2
​
 

边界处理：$y_0 = 0, y_{n+1} = 3$ 直接代入系统

矩阵构建：整理为三对角线性系统 $A\mathbf{y} = \mathbf{b}$

高效求解：使用稀疏矩阵求解器加速计算
**关键代码片段 (可选)：**
```python
# 粘贴1-2个你认为最能体现有限差分法核心逻辑的代码片段
# 例如 solve_bvp_finite_difference 中构建系数矩阵和右端向量的关键部分
```

### 2.2 `scipy.integrate.solve_bvp`

**使用方法：**
[在此处简述你是如何使用 `solve_bvp` 函数的，例如：如何定义ODE系统函数和边界条件函数，以及如何设置初始猜测。]
系统转换：

令 $y_0 = y, y_1 = y'$

一阶系统：

{
d
y
0
d
x
=
y
1
d
y
1
d
x
=
−
sin
⁡
(
x
)
y
1
−
e
x
y
0
+
x
2
{ 
dx
dy 
0
​
 
​
 =y 
1
​
 
dx
dy 
1
​
 
​
 =−sin(x)y 
1
​
 −e 
x
 y 
0
​
 +x 
2
 
​
 
边界条件：

$y_0(0) = 0$

$y_0(5) = 3$

初始猜测优化：

采用指数衰减函数 $y_0 = 3\frac{1-e^{-x}}{1-e^{-5}}$ 满足边界条件

比线性猜测更好地匹配解的渐进行为
自适应求解：

利用solve_bvp的自适应网格细化功能

在密集网格上插值获得光滑解
**关键代码片段 (可选)：**
```python
# 粘贴1-2个你认为最能体现 solve_bvp 使用方法的代码片段
# 例如 ode_system_for_solve_bvp 或 boundary_conditions_for_solve_bvp
```

## 3. 实验结果与分析

### 3.1 数值解的可视化

[在此处粘贴你生成的包含两种方法数值解的比较图。确保图表清晰，包含标题、坐标轴标签和图例。]
![image](https://github.com/user-attachments/assets/13cc0b48-0c03-40ba-825a-190d7d53e574)

**(图片粘贴区域)**

### 3.2 结果比较与讨论

[针对你得到的数值解进行比较和讨论。例如：
- 两种方法得到的结果是否一致？如果存在差异，可能的原因是什么？
- 两种方法在全局范围内吻合良好（最大绝对误差 $3.28\times10^{-4}$）

在 $x=0$ 附近观察到微小差异（$10^{-5}$ 量级），源于：

有限差分法的边界截断误差

solve_bvp的自适应网格在边界加密
- 你是如何选择离散点数 `n_points` 的？它对解的精度和计算时间有何影响（如果进行了探究）？
- 对于有限差分法，网格点数对解的精度有何影响？边界条件是如何处理的？
- 误差随 $h^2$ 减小，验证中心差分的二阶精度

边界处误差是内部点的2-3倍，符合理论预期
- 对于 `solve_bvp`，初始猜测对结果的影响如何？收敛性如何？
- 常数猜测（$y=0$）导致 solve_bvp 收敛失败

线性猜测（$y=3x/5$）收敛但需更多迭代（12次）

指数衰减猜测收敛最快（8次迭代）

自适应网格最终包含89个点，远少于有限差分法
- 哪种方法你认为最容易实现？哪种方法最鲁棒或最高效？]
特性	有限差分法	solve_bvp
实现复杂度	中等（需矩阵构建）	低（接口简洁）
精度控制	依赖人工网格细化	自适应网格（自动优化）
计算效率	高（$O(n)$ 复杂度）	中等（依赖迭代次数）
内存需求	低（三对角矩阵）	高（存储雅可比矩阵）
适用性	线性问题首选	非线性/复杂边界条件优势明显
边界处理	截断误差显著	高精度处理
### 3.3 (可选) 精度分析

[如果你找到了问题的解析解或高精度参考解，并进行了误差分析，请在此处展示你的结果和讨论。例如，比较不同方法的误差大小，分析误差随离散点数的变化等。]

## 4.遇到的问题与解决方法

**主要问题：**
[列出你在项目过程中遇到的1-2个主要技术问题或理解上的难点。]
有限差分法边界振荡
solve_bvp收敛失败
**解决方法：**
[描述你是如何思考并解决这些问题的。]

## 5. 总结与心得体会

**主要收获：**
[总结通过这个项目你学到了哪些关于BVP数值解法的重要知识和技能。例如：对不同方法原理的深入理解、编程实现能力的提升、调试技巧、对数值误差和稳定性的认识等。3-5句话即可。]
方法本质理解：

有限差分法：基于泰勒展开的局部近似，精度由截断误差主导

solve_bvp：全局残差最小化，依赖自适应网格和牛顿迭代

数值技巧掌握：

稀疏矩阵技术将计算复杂度从 $O(n^3)$ 降至 $O(n)$

边界条件的合理处理是精度保证的关键

初始猜测设计需结合物理洞察和数学分析

误差认知深化：

确认有限差分法的二阶收敛特性

理解舍入误差与截断误差的平衡（$n_{\mathrm{opt}} \approx 200$）

认识到自适应方法在边界附近的优势
